{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport setAuthToken from \"../utils/setAuthToken\";\nimport axios from \"axios\";\nimport { clear_profile } from \"./profileSlice\";\nconst initialState = {\n  auth: null,\n  token: localStorage.getItem('token'),\n  loading: true,\n  user: null\n};\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    register_success(state, action) {\n      state.auth = true;\n      state.loading = false;\n      localStorage.setItem('token', action.payload.token);\n    },\n    log_out(state, action) {\n      localStorage.removeItem('token');\n      state.auth = null;\n      state.loading = false;\n      state.user = null;\n    },\n    user_loaded(state, action) {\n      state.auth = true;\n      state.loading = false;\n      state.user = action.payload;\n    }\n  }\n});\nexport function loadUser() {\n  return async function userLoadedThunks(dispatch, getState) {\n    if (localStorage.token) {\n      // console.log(localStorage.token);\n      // console.log(localStorage.getItem('token'));\n      setAuthToken(localStorage.getItem('token'));\n    }\n    try {\n      const res = await axios.get('http://localhost:5000/api/auth');\n      dispatch(user_loaded(res.data));\n    } catch (err) {\n      dispatch(clear_profile());\n      dispatch(log_out());\n    }\n  };\n}\nexport const {\n  register_success,\n  log_out,\n  user_loaded\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","setAuthToken","axios","clear_profile","initialState","auth","token","localStorage","getItem","loading","user","authSlice","name","reducers","register_success","state","action","setItem","payload","log_out","removeItem","user_loaded","loadUser","userLoadedThunks","dispatch","getState","res","get","data","err","actions","reducer"],"sources":["C:/Users/rnirm/Downloads/mern/frontend/src/reducer/authSlice.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\r\nimport setAuthToken from \"../utils/setAuthToken\";\r\nimport axios from \"axios\";\r\nimport { clear_profile } from \"./profileSlice\";\r\nconst initialState = {\r\n    auth:null,\r\n    token:localStorage.getItem('token'),\r\n    loading:true,\r\n    user:null\r\n}\r\n\r\nconst authSlice= createSlice({\r\n    name:\"auth\",\r\n    initialState,\r\n    reducers:{\r\n        register_success(state,action){\r\n            state.auth=true;\r\n            state.loading=false;\r\n            localStorage.setItem('token',action.payload.token);\r\n        },\r\n        log_out(state,action){\r\n            localStorage.removeItem('token');\r\n            state.auth=null;\r\n            state.loading=false;\r\n            state.user=null;\r\n        },\r\n        user_loaded(state,action){\r\n            state.auth=true;\r\n            state.loading=false;\r\n            state.user=action.payload;\r\n        }\r\n    }\r\n})\r\n\r\nexport function loadUser(){\r\n    return async function userLoadedThunks(dispatch,getState){\r\n        if(localStorage.token){\r\n            // console.log(localStorage.token);\r\n            // console.log(localStorage.getItem('token'));\r\n            setAuthToken(localStorage.getItem('token'));\r\n        }\r\n        \r\n        try {\r\n            const res= await axios.get('http://localhost:5000/api/auth');\r\n            dispatch(user_loaded(res.data));\r\n        } catch (err) {\r\n            dispatch(clear_profile());\r\n            dispatch(log_out());\r\n        }\r\n    }\r\n}\r\n\r\nexport const {register_success,log_out,user_loaded} = authSlice.actions;\r\nexport default authSlice.reducer;"],"mappings":"AAAA,SAASA,WAAW,QAAQ,kBAAkB;AAC9C,OAAOC,YAAY,MAAM,uBAAuB;AAChD,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,aAAa,QAAQ,gBAAgB;AAC9C,MAAMC,YAAY,GAAG;EACjBC,IAAI,EAAC,IAAI;EACTC,KAAK,EAACC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EACnCC,OAAO,EAAC,IAAI;EACZC,IAAI,EAAC;AACT,CAAC;AAED,MAAMC,SAAS,GAAEX,WAAW,CAAC;EACzBY,IAAI,EAAC,MAAM;EACXR,YAAY;EACZS,QAAQ,EAAC;IACLC,gBAAgBA,CAACC,KAAK,EAACC,MAAM,EAAC;MAC1BD,KAAK,CAACV,IAAI,GAAC,IAAI;MACfU,KAAK,CAACN,OAAO,GAAC,KAAK;MACnBF,YAAY,CAACU,OAAO,CAAC,OAAO,EAACD,MAAM,CAACE,OAAO,CAACZ,KAAK,CAAC;IACtD,CAAC;IACDa,OAAOA,CAACJ,KAAK,EAACC,MAAM,EAAC;MACjBT,YAAY,CAACa,UAAU,CAAC,OAAO,CAAC;MAChCL,KAAK,CAACV,IAAI,GAAC,IAAI;MACfU,KAAK,CAACN,OAAO,GAAC,KAAK;MACnBM,KAAK,CAACL,IAAI,GAAC,IAAI;IACnB,CAAC;IACDW,WAAWA,CAACN,KAAK,EAACC,MAAM,EAAC;MACrBD,KAAK,CAACV,IAAI,GAAC,IAAI;MACfU,KAAK,CAACN,OAAO,GAAC,KAAK;MACnBM,KAAK,CAACL,IAAI,GAACM,MAAM,CAACE,OAAO;IAC7B;EACJ;AACJ,CAAC,CAAC;AAEF,OAAO,SAASI,QAAQA,CAAA,EAAE;EACtB,OAAO,eAAeC,gBAAgBA,CAACC,QAAQ,EAACC,QAAQ,EAAC;IACrD,IAAGlB,YAAY,CAACD,KAAK,EAAC;MAClB;MACA;MACAL,YAAY,CAACM,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC;IAC/C;IAEA,IAAI;MACA,MAAMkB,GAAG,GAAE,MAAMxB,KAAK,CAACyB,GAAG,CAAC,gCAAgC,CAAC;MAC5DH,QAAQ,CAACH,WAAW,CAACK,GAAG,CAACE,IAAI,CAAC,CAAC;IACnC,CAAC,CAAC,OAAOC,GAAG,EAAE;MACVL,QAAQ,CAACrB,aAAa,CAAC,CAAC,CAAC;MACzBqB,QAAQ,CAACL,OAAO,CAAC,CAAC,CAAC;IACvB;EACJ,CAAC;AACL;AAEA,OAAO,MAAM;EAACL,gBAAgB;EAACK,OAAO;EAACE;AAAW,CAAC,GAAGV,SAAS,CAACmB,OAAO;AACvE,eAAenB,SAAS,CAACoB,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}